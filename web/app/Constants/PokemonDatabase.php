<?php

declare(strict_types=1);

namespace App\Constants;

use App\Domain\Pokemon;

/**
 * ポケモンデータベース.
 *
 * Data source: pokemongo-get.com/cpcal/
 */
final class PokemonDatabase
{
    /** @var null|array<string, Pokemon> */
    private static ?array $cache = null;

    /**
     * 日本語名からポケモンを検索.
     */
    public static function findByName(string $name): ?Pokemon
    {
        $db = self::getDatabase();

        return $db[$name] ?? null;
    }

    /**
     * 図鑑番号からポケモンを検索（最初に見つかったもの）.
     */
    public static function findByDex(int $dex): ?Pokemon
    {
        foreach (self::getDatabase() as $pokemon) {
            if ($pokemon->dex === $dex) {
                return $pokemon;
            }
        }

        return null;
    }

    /**
     * @return array<string, Pokemon>
     */
    private static function getDatabase(): array
    {
        if (self::$cache !== null) {
            return self::$cache;
        }

        self::$cache = self::buildDatabase();

        return self::$cache;
    }

    /**
     * @return array<string, Pokemon>
     */
    private static function buildDatabase(): array
    {
        $db = [];
        $entries = self::rawEntries();

        foreach ($entries as [$name, $dex, $atk, $def, $sta]) {
            $db[$name] = new Pokemon(
                name: $name,
                dex: $dex,
                baseAttack: $atk,
                baseDefense: $def,
                baseStamina: $sta,
            );
        }

        return $db;
    }

    /**
     * [名前, 図鑑番号, 攻撃種族値, 防御種族値, HP種族値].
     *
     * @return list<array{0: string, 1: int, 2: int, 3: int, 4: int}>
     */
    private static function rawEntries(): array
    {
        return [
            // --- Gen 1 (001-151) ---
            ['フシギダネ', 1, 118, 111, 128],
            ['フシギソウ', 2, 151, 143, 155],
            ['フシギバナ', 3, 198, 189, 190],
            ['フシギバナ(キョダイ)', 3, 198, 189, 190],
            ['ヒトカゲ', 4, 116, 93, 118],
            ['リザード', 5, 158, 126, 151],
            ['リザードン', 6, 223, 173, 186],
            ['リザードン(キョダイ)', 6, 223, 173, 186],
            ['ゼニガメ', 7, 94, 121, 127],
            ['カメール', 8, 126, 155, 153],
            ['カメックス', 9, 171, 207, 188],
            ['カメックス(キョダイ)', 9, 171, 207, 188],
            ['キャタピー', 10, 55, 55, 128],
            ['トランセル', 11, 45, 80, 137],
            ['バタフリー', 12, 167, 137, 155],
            ['ビードル', 13, 63, 50, 120],
            ['コクーン', 14, 46, 75, 128],
            ['スピアー', 15, 169, 130, 163],
            ['ポッポ', 16, 85, 73, 120],
            ['ピジョン', 17, 117, 105, 160],
            ['ピジョット', 18, 166, 154, 195],
            ['コラッタ', 19, 103, 70, 102],
            ['コラッタ(アローラ)', 19, 103, 70, 102],
            ['ラッタ', 20, 161, 139, 146],
            ['ラッタ(アローラ)', 20, 135, 154, 181],
            ['オニスズメ', 21, 112, 60, 120],
            ['オニドリル', 22, 182, 133, 163],
            ['アーボ', 23, 110, 97, 111],
            ['アーボック', 24, 167, 153, 155],
            ['ピカチュウ', 25, 112, 96, 111],
            ['ライチュウ', 26, 193, 151, 155],
            ['ライチュウ(アローラ)', 26, 201, 154, 155],
            ['サンド', 27, 126, 120, 137],
            ['サンド(アローラ)', 27, 125, 129, 137],
            ['サンドパン', 28, 182, 175, 181],
            ['サンドパン(アローラ)', 28, 177, 195, 181],
            ['ニドラン♀', 29, 86, 89, 146],
            ['ニドリーナ', 30, 117, 120, 172],
            ['ニドクイン', 31, 180, 173, 207],
            ['ニドラン♂', 32, 105, 76, 130],
            ['ニドリーノ', 33, 137, 111, 156],
            ['ニドキング', 34, 204, 156, 191],
            ['ピッピ', 35, 107, 108, 172],
            ['ピクシー', 36, 178, 162, 216],
            ['ロコン', 37, 96, 109, 116],
            ['ロコン(アローラ)', 37, 96, 109, 116],
            ['キュウコン', 38, 169, 190, 177],
            ['キュウコン(アローラ)', 38, 170, 193, 177],
            ['プリン', 39, 80, 41, 251],
            ['プクリン', 40, 156, 90, 295],
            ['ズバット', 41, 83, 73, 120],
            ['ゴルバット', 42, 161, 150, 181],
            ['ナゾノクサ', 43, 131, 112, 128],
            ['クサイハナ', 44, 153, 136, 155],
            ['ラフレシア', 45, 202, 167, 181],
            ['パラス', 46, 121, 99, 111],
            ['パラセクト', 47, 165, 146, 155],
            ['コンパン', 48, 100, 100, 155],
            ['モルフォン', 49, 179, 143, 172],
            ['ディグダ', 50, 109, 78, 67],
            ['ディグダ(アローラ)', 50, 108, 81, 67],
            ['ダグトリオ', 51, 167, 134, 111],
            ['ダグトリオ(アローラ)', 51, 201, 142, 111],
            ['ニャース', 52, 92, 78, 120],
            ['ニャース(アローラ)', 52, 99, 78, 120],
            ['ニャース(ガラル)', 52, 115, 92, 137],
            ['ペルシアン', 53, 150, 136, 163],
            ['ペルシアン(アローラ)', 53, 158, 136, 163],
            ['コダック', 54, 122, 95, 137],
            ['ゴルダック', 55, 191, 162, 190],
            ['マンキー', 56, 148, 82, 120],
            ['オコリザル', 57, 207, 138, 163],
            ['ガーディ', 58, 136, 93, 146],
            ['ガーディ(ヒスイ)', 58, 116, 117, 155],
            ['ウインディ', 59, 227, 166, 207],
            ['ウインディ(ヒスイ)', 59, 214, 165, 216],
            ['ニョロモ', 60, 101, 82, 120],
            ['ニョロゾ', 61, 130, 123, 163],
            ['ニョロボン', 62, 182, 184, 207],
            ['ケーシィ', 63, 195, 75, 93],
            ['ユンゲラー', 64, 232, 117, 120],
            ['フーディン', 65, 271, 167, 146],
            ['ワンリキー', 66, 137, 82, 172],
            ['ゴーリキー', 67, 177, 125, 190],
            ['カイリキー', 68, 234, 159, 207],
            ['マダツボミ', 69, 139, 61, 137],
            ['ウツドン', 70, 172, 92, 163],
            ['ウツボット', 71, 207, 135, 190],
            ['メノクラゲ', 72, 97, 149, 120],
            ['ドククラゲ', 73, 166, 209, 190],
            ['イシツブテ', 74, 132, 132, 120],
            ['イシツブテ(アローラ)', 74, 132, 132, 120],
            ['ゴローン', 75, 164, 164, 146],
            ['ゴローン(アローラ)', 75, 164, 164, 146],
            ['ゴローニャ', 76, 211, 198, 190],
            ['ゴローニャ(アローラ)', 76, 211, 198, 190],
            ['ポニータ', 77, 170, 127, 137],
            ['ポニータ(ガラル)', 77, 170, 127, 137],
            ['ギャロップ', 78, 207, 162, 163],
            ['ギャロップ(ガラル)', 78, 207, 162, 163],
            ['ヤドン', 79, 109, 98, 207],
            ['ヤドン(ガラル)', 79, 109, 98, 207],
            ['ヤドラン', 80, 177, 180, 216],
            ['ヤドラン(ガラル)', 80, 182, 156, 216],
            ['コイル', 81, 165, 121, 93],
            ['レアコイル', 82, 223, 169, 137],
            ['カモネギ', 83, 124, 115, 141],
            ['カモネギ(ガラル)', 83, 174, 114, 141],
            ['ドードー', 84, 158, 83, 111],
            ['ドードリオ', 85, 218, 140, 155],
            ['パウワウ', 86, 85, 121, 163],
            ['ジュゴン', 87, 139, 177, 207],
            ['ベトベター', 88, 135, 90, 190],
            ['ベトベター(アローラ)', 88, 135, 90, 190],
            ['ベトベトン', 89, 190, 172, 233],
            ['ベトベトン(アローラ)', 89, 190, 172, 233],
            ['シェルダー', 90, 116, 134, 102],
            ['パルシェン', 91, 186, 256, 137],
            ['ゴース', 92, 186, 67, 102],
            ['ゴースト', 93, 223, 107, 128],
            ['ゲンガー', 94, 261, 149, 155],
            ['イワーク', 95, 85, 232, 111],
            ['スリープ', 96, 89, 136, 155],
            ['スリーパー', 97, 144, 193, 198],
            ['クラブ', 98, 181, 124, 102],
            ['キングラー', 99, 240, 181, 146],
            ['ビリリダマ', 100, 109, 111, 120],
            ['ビリリダマ(ヒスイ)', 100, 109, 111, 120],
            ['マルマイン', 101, 173, 173, 155],
            ['マルマイン(ヒスイ)', 101, 173, 173, 155],
            ['タマタマ', 102, 107, 125, 155],
            ['ナッシー', 103, 233, 149, 216],
            ['ナッシー(アローラ)', 103, 230, 153, 216],
            ['カラカラ', 104, 90, 144, 137],
            ['ガラガラ', 105, 144, 186, 155],
            ['ガラガラ(アローラ)', 105, 144, 186, 155],
            ['サワムラー', 106, 224, 181, 137],
            ['エビワラー', 107, 193, 197, 137],
            ['ベロリンガ', 108, 108, 137, 207],
            ['ドガース', 109, 119, 141, 120],
            ['マタドガス', 110, 174, 197, 163],
            ['マタドガス(ガラル)', 110, 174, 197, 163],
            ['サイホーン', 111, 140, 127, 190],
            ['サイドン', 112, 222, 171, 233],
            ['ラッキー', 113, 60, 128, 487],
            ['モンジャラ', 114, 183, 169, 163],
            ['ガルーラ', 115, 181, 165, 233],
            ['タッツー', 116, 129, 103, 102],
            ['シードラ', 117, 187, 156, 146],
            ['トサキント', 118, 123, 110, 128],
            ['アズマオウ', 119, 175, 147, 190],
            ['ヒトデマン', 120, 137, 112, 102],
            ['スターミー', 121, 210, 184, 155],
            ['バリヤード', 122, 192, 205, 120],
            ['バリヤード(ガラル)', 122, 183, 169, 137],
            ['ストライク', 123, 218, 170, 172],
            ['ルージュラ', 124, 223, 151, 163],
            ['エレブー', 125, 198, 158, 163],
            ['ブーバー', 126, 206, 154, 163],
            ['カイロス', 127, 238, 182, 163],
            ['ケンタロス', 128, 198, 183, 181],
            ['コイキング', 129, 29, 85, 85],
            ['ギャラドス', 130, 237, 186, 216],
            ['ラプラス', 131, 165, 174, 277],
            ['メタモン', 132, 91, 91, 134],
            ['イーブイ', 133, 104, 114, 146],
            ['シャワーズ', 134, 205, 161, 277],
            ['サンダース', 135, 232, 182, 163],
            ['ブースター', 136, 246, 179, 163],
            ['ポリゴン', 137, 153, 136, 163],
            ['オムナイト', 138, 155, 153, 111],
            ['オムスター', 139, 207, 201, 172],
            ['カブト', 140, 148, 140, 102],
            ['カブトプス', 141, 220, 186, 155],
            ['プテラ', 142, 221, 159, 190],
            ['カビゴン', 143, 190, 169, 330],
            ['フリーザー', 144, 192, 236, 207],
            ['フリーザー(ガラル)', 144, 192, 236, 207],
            ['サンダー', 145, 253, 185, 207],
            ['サンダー(ガラル)', 145, 252, 182, 207],
            ['ファイヤー', 146, 251, 181, 207],
            ['ファイヤー(ガラル)', 146, 252, 181, 207],
            ['ミニリュウ', 147, 119, 91, 121],
            ['ハクリュー', 148, 163, 135, 156],
            ['カイリュー', 149, 263, 198, 209],
            ['ミュウツー', 150, 300, 182, 214],
            ['ミュウ', 151, 210, 210, 225],
            // --- Gen 2 (152-251) ---
            ['チコリータ', 152, 92, 122, 128],
            ['ベイリーフ', 153, 122, 155, 155],
            ['メガニウム', 154, 168, 202, 190],
            ['ヒノアラシ', 155, 116, 93, 118],
            ['マグマラシ', 156, 158, 126, 151],
            ['バクフーン', 157, 223, 173, 186],
            ['ワニノコ', 158, 117, 109, 137],
            ['アリゲイツ', 159, 150, 142, 163],
            ['オーダイル', 160, 205, 188, 198],
            ['オタチ', 161, 79, 73, 111],
            ['オオタチ', 162, 148, 125, 198],
            ['ホーホー', 163, 67, 88, 155],
            ['ヨルノズク', 164, 145, 156, 225],
            ['レディバ', 165, 72, 118, 120],
            ['レディアン', 166, 107, 179, 146],
            ['イトマル', 167, 105, 73, 120],
            ['アリアドス', 168, 161, 124, 172],
            ['クロバット', 169, 194, 178, 198],
            ['チョンチー', 170, 106, 97, 181],
            ['ランターン', 171, 146, 137, 268],
            ['ピチュー', 172, 77, 53, 85],
            ['ピィ', 173, 75, 79, 137],
            ['ププリン', 174, 69, 34, 207],
            ['トゲピー', 175, 67, 116, 111],
            ['トゲチック', 176, 139, 181, 146],
            ['ネイティ', 177, 134, 89, 120],
            ['ネイティオ', 178, 192, 146, 163],
            ['メリープ', 179, 114, 79, 146],
            ['モココ', 180, 145, 109, 172],
            ['デンリュウ', 181, 211, 169, 207],
            ['キレイハナ', 182, 169, 186, 181],
            ['マリル', 183, 37, 93, 172],
            ['マリルリ', 184, 112, 152, 225],
            ['ウソッキー', 185, 167, 176, 172],
            ['ニョロトノ', 186, 174, 179, 207],
            ['ハネッコ', 187, 67, 94, 111],
            ['ポポッコ', 188, 91, 120, 146],
            ['ワタッコ', 189, 118, 183, 181],
            ['エイパム', 190, 136, 112, 146],
            ['ヒマナッツ', 191, 55, 55, 102],
            ['キマワリ', 192, 185, 135, 181],
            ['ヤンヤンマ', 193, 154, 94, 163],
            ['ウパー', 194, 75, 66, 146],
            ['ヌオー', 195, 152, 143, 216],
            ['エーフィ', 196, 261, 175, 163],
            ['ブラッキー', 197, 126, 240, 216],
            ['ヤミカラス', 198, 175, 87, 155],
            ['ヤドキング', 199, 177, 180, 216],
            ['ヤドキング(ガラル)', 199, 190, 180, 216],
            ['ムウマ', 200, 167, 154, 155],
            ['アンノーン', 201, 136, 91, 134],
            ['ソーナンス', 202, 60, 106, 382],
            ['キリンリキ', 203, 182, 133, 172],
            ['クヌギダマ', 204, 108, 122, 137],
            ['フォレトス', 205, 161, 205, 181],
            ['ノコッチ', 206, 131, 128, 225],
            ['グライガー', 207, 143, 184, 163],
            ['ハガネール', 208, 148, 272, 181],
            ['ブルー', 209, 137, 85, 155],
            ['グランブル', 210, 212, 131, 207],
            ['ハリーセン', 211, 184, 138, 163],
            ['ハッサム', 212, 236, 181, 172],
            ['ツボツボ', 213, 17, 396, 85],
            ['ヘラクロス', 214, 234, 179, 190],
            ['ニューラ', 215, 189, 146, 146],
            ['ヒメグマ', 216, 142, 93, 155],
            ['リングマ', 217, 236, 144, 207],
            ['マグマッグ', 218, 118, 71, 120],
            ['マグカルゴ', 219, 139, 191, 137],
            ['ウリムー', 220, 90, 69, 137],
            ['イノムー', 221, 181, 138, 225],
            ['サニーゴ', 222, 118, 156, 146],
            ['テッポウオ', 223, 127, 69, 111],
            ['オクタン', 224, 197, 141, 181],
            ['デリバード', 225, 128, 90, 128],
            ['マンタイン', 226, 148, 226, 163],
            ['エアームド', 227, 148, 226, 163],
            ['デルビル', 228, 152, 83, 128],
            ['ヘルガー', 229, 224, 144, 181],
            ['キングドラ', 230, 194, 194, 181],
            ['ゴマゾウ', 231, 107, 98, 207],
            ['ドンファン', 232, 214, 185, 207],
            ['ポリゴン2', 233, 198, 180, 198],
            ['オドシシ', 234, 192, 131, 177],
            ['ドーブル', 235, 40, 83, 146],
            ['バルキー', 236, 64, 64, 111],
            ['カポエラー', 237, 173, 207, 137],
            ['ムチュール', 238, 153, 91, 128],
            ['エレキッド', 239, 135, 101, 128],
            ['ブビィ', 240, 151, 99, 128],
            ['ミルタンク', 241, 157, 193, 216],
            ['ハピナス', 242, 129, 169, 496],
            ['ライコウ', 243, 241, 195, 207],
            ['エンテイ', 244, 235, 171, 251],
            ['スイクン', 245, 180, 235, 225],
            ['ヨーギラス', 246, 115, 93, 137],
            ['サナギラス', 247, 155, 133, 172],
            ['バンギラス', 248, 251, 207, 225],
            ['ルギア', 249, 193, 310, 235],
            ['ホウオウ', 250, 239, 244, 214],
            ['セレビィ', 251, 210, 210, 225],
            // --- Gen 3 starters + popular ---
            ['キモリ', 252, 124, 94, 120],
            ['ジュプトル', 253, 172, 120, 137],
            ['ジュカイン', 254, 223, 169, 172],
            ['アチャモ', 255, 130, 87, 128],
            ['ワカシャモ', 256, 163, 115, 155],
            ['バシャーモ', 257, 240, 141, 190],
            ['ミズゴロウ', 258, 126, 93, 137],
            ['ヌマクロー', 259, 156, 133, 172],
            ['ラグラージ', 260, 208, 175, 225],
            ['ラルトス', 280, 79, 59, 99],
            ['キルリア', 281, 117, 90, 116],
            ['サーナイト', 282, 237, 195, 169],
            ['マクノシタ', 296, 99, 54, 176],
            ['ハリテヤマ', 297, 209, 114, 302],
            ['ヤミラミ', 302, 141, 136, 137],
            ['クチート', 303, 155, 141, 137],
            ['ココドラ', 304, 121, 141, 137],
            ['コドラ', 305, 158, 198, 155],
            ['ボスゴドラ', 306, 198, 257, 172],
            ['チャーレム', 308, 121, 152, 155],
            ['チルタリス', 334, 141, 201, 181],
            ['ナックラー', 328, 162, 78, 128],
            ['ビブラーバ', 329, 134, 99, 137],
            ['フライゴン', 330, 205, 168, 190],
            ['ヒンバス', 349, 29, 85, 85],
            ['ミロカロス', 350, 192, 219, 216],
            ['タツベイ', 371, 134, 93, 128],
            ['コモルー', 372, 172, 155, 163],
            ['ボーマンダ', 373, 277, 168, 216],
            ['ダンバル', 374, 96, 132, 120],
            ['メタング', 375, 138, 176, 155],
            ['メタグロス', 376, 257, 228, 190],
            ['レジロック', 377, 179, 309, 190],
            ['レジアイス', 378, 179, 309, 190],
            ['レジスチル', 379, 143, 285, 190],
            ['ラティアス', 380, 228, 246, 190],
            ['ラティオス', 381, 268, 212, 190],
            ['カイオーガ', 382, 270, 228, 205],
            ['グラードン', 383, 270, 228, 205],
            ['レックウザ', 384, 284, 170, 213],
            ['ジラーチ', 385, 210, 210, 225],
            ['デオキシス', 386, 345, 115, 137],
            // --- Gen 4 popular ---
            ['ナエトル', 387, 119, 110, 146],
            ['ハヤシガメ', 388, 157, 143, 172],
            ['ドダイトス', 389, 202, 188, 216],
            ['ヒコザル', 390, 113, 86, 127],
            ['モウカザル', 391, 158, 105, 162],
            ['ゴウカザル', 392, 222, 151, 186],
            ['ポッチャマ', 393, 112, 102, 142],
            ['ポッタイシ', 394, 150, 139, 162],
            ['エンペルト', 395, 210, 186, 197],
            ['コリンク', 403, 117, 64, 128],
            ['ルクシオ', 404, 159, 95, 155],
            ['レントラー', 405, 232, 156, 190],
            ['フカマル', 443, 124, 84, 151],
            ['ガバイト', 444, 172, 125, 169],
            ['ガブリアス', 445, 261, 193, 239],
            ['リオル', 447, 127, 78, 120],
            ['ルカリオ', 448, 236, 144, 172],
            ['トゲキッス', 468, 225, 217, 198],
            ['マニューラ', 461, 243, 171, 172],
            ['リーフィア', 470, 216, 219, 163],
            ['グレイシア', 471, 238, 205, 163],
            ['マンムー', 473, 247, 146, 242],
            ['エルレイド', 475, 237, 195, 169],
            ['ポリゴンZ', 474, 264, 150, 198],
            ['ディアルガ', 483, 275, 211, 205],
            ['パルキア', 484, 280, 215, 189],
            ['ギラティナ', 487, 187, 225, 284],
            ['ギラティナ(アナザー)', 487, 187, 225, 284],
            ['ギラティナ(オリジン)', 487, 225, 187, 284],
            ['ダークライ', 491, 285, 198, 172],
            // --- Gen 5+ popular ---
            ['デデンネ', 702, 164, 134, 167],
            ['メルタン', 808, 118, 99, 130],
            ['メルメタル', 809, 226, 190, 264],
        ];
    }
}
