<?php

declare(strict_types=1);

namespace App\Constants;

use App\Domain\Pokemon;

/**
 * 進化チェーンデータベース.
 *
 * pogoapi.netのデータを元に生成.
 * 再生成: python scripts/sync_pokemon_data.py
 */
final class EvolutionDatabase
{
    /**
     * 前方進化マップ（直接の進化先のみ）.
     *
     * @var array<string, list<string>>
     */
    private const EVOLUTIONS = [
        'アチャモ' => ['ワカシャモ'],
        'アリゲイツ' => ['オーダイル'],
        'アーボ' => ['アーボック'],
        'イシツブテ' => ['ゴローン'],
        'イシツブテ(アローラ)' => ['ゴローン(アローラ)'],
        'イトマル' => ['アリアドス'],
        'イノムー' => ['マンムー'],
        'イワーク' => ['ハガネール'],
        'イーブイ' => ['シャワーズ', 'サンダース', 'ブースター', 'エーフィ', 'ブラッキー', 'リーフィア', 'グレイシア'],
        'ウツドン' => ['ウツボット'],
        'ウパー' => ['ヌオー'],
        'ウリムー' => ['イノムー'],
        'エレキッド' => ['エレブー'],
        'オタチ' => ['オオタチ'],
        'オニスズメ' => ['オニドリル'],
        'オムナイト' => ['オムスター'],
        'カブト' => ['カブトプス'],
        'カメール' => ['カメックス'],
        'カラカラ' => ['ガラガラ', 'ガラガラ(アローラ)'],
        'ガバイト' => ['ガブリアス'],
        'ガーディ' => ['ウインディ'],
        'ガーディ(ヒスイ)' => ['ウインディ(ヒスイ)'],
        'キモリ' => ['ジュプトル'],
        'キャタピー' => ['トランセル'],
        'キルリア' => ['エルレイド', 'サーナイト'],
        'クサイハナ' => ['ラフレシア', 'キレイハナ'],
        'クヌギダマ' => ['フォレトス'],
        'クラブ' => ['キングラー'],
        'ケーシィ' => ['ユンゲラー'],
        'コイキング' => ['ギャラドス'],
        'コイル' => ['レアコイル'],
        'コクーン' => ['スピアー'],
        'ココドラ' => ['コドラ'],
        'コダック' => ['ゴルダック'],
        'コドラ' => ['ボスゴドラ'],
        'コモルー' => ['ボーマンダ'],
        'コラッタ' => ['ラッタ'],
        'コラッタ(アローラ)' => ['ラッタ(アローラ)'],
        'コリンク' => ['ルクシオ'],
        'コンパン' => ['モルフォン'],
        'ゴマゾウ' => ['ドンファン'],
        'ゴルバット' => ['クロバット'],
        'ゴローン' => ['ゴローニャ'],
        'ゴローン(アローラ)' => ['ゴローニャ(アローラ)'],
        'ゴース' => ['ゴースト'],
        'ゴースト' => ['ゲンガー'],
        'ゴーリキー' => ['カイリキー'],
        'サイホーン' => ['サイドン'],
        'サナギラス' => ['バンギラス'],
        'サンド' => ['サンドパン'],
        'サンド(アローラ)' => ['サンドパン(アローラ)'],
        'シェルダー' => ['パルシェン'],
        'シードラ' => ['キングドラ'],
        'ジュプトル' => ['ジュカイン'],
        'ストライク' => ['ハッサム'],
        'スリープ' => ['スリーパー'],
        'ズバット' => ['ゴルバット'],
        'ゼニガメ' => ['カメール'],
        'タッツー' => ['シードラ'],
        'タツベイ' => ['コモルー'],
        'タマタマ' => ['ナッシー', 'ナッシー(アローラ)'],
        'ダンバル' => ['メタング'],
        'チコリータ' => ['ベイリーフ'],
        'チョンチー' => ['ランターン'],
        'テッポウオ' => ['オクタン'],
        'ディグダ' => ['ダグトリオ'],
        'ディグダ(アローラ)' => ['ダグトリオ(アローラ)'],
        'デルビル' => ['ヘルガー'],
        'トゲチック' => ['トゲキッス'],
        'トゲピー' => ['トゲチック'],
        'トサキント' => ['アズマオウ'],
        'トランセル' => ['バタフリー'],
        'ドガース' => ['マタドガス', 'マタドガス(ガラル)'],
        'ドードー' => ['ドードリオ'],
        'ナエトル' => ['ハヤシガメ'],
        'ナゾノクサ' => ['クサイハナ'],
        'ナックラー' => ['ビブラーバ'],
        'ニドラン♀' => ['ニドリーナ'],
        'ニドラン♂' => ['ニドリーノ'],
        'ニドリーナ' => ['ニドクイン'],
        'ニドリーノ' => ['ニドキング'],
        'ニャース' => ['ペルシアン'],
        'ニャース(アローラ)' => ['ペルシアン(アローラ)'],
        'ニューラ' => ['マニューラ'],
        'ニョロゾ' => ['ニョロボン', 'ニョロトノ'],
        'ニョロモ' => ['ニョロゾ'],
        'ヌマクロー' => ['ラグラージ'],
        'ネイティ' => ['ネイティオ'],
        'ハクリュー' => ['カイリュー'],
        'ハネッコ' => ['ポポッコ'],
        'ハヤシガメ' => ['ドダイトス'],
        'バルキー' => ['サワムラー', 'エビワラー', 'カポエラー'],
        'パウワウ' => ['ジュゴン'],
        'パラス' => ['パラセクト'],
        'ヒコザル' => ['モウカザル'],
        'ヒトカゲ' => ['リザード'],
        'ヒトデマン' => ['スターミー'],
        'ヒノアラシ' => ['マグマラシ'],
        'ヒマナッツ' => ['キマワリ'],
        'ヒメグマ' => ['リングマ'],
        'ヒンバス' => ['ミロカロス'],
        'ビブラーバ' => ['フライゴン'],
        'ビリリダマ' => ['マルマイン'],
        'ビリリダマ(ヒスイ)' => ['マルマイン(ヒスイ)'],
        'ビードル' => ['コクーン'],
        'ピィ' => ['ピッピ'],
        'ピカチュウ' => ['ライチュウ', 'ライチュウ(アローラ)'],
        'ピジョン' => ['ピジョット'],
        'ピチュー' => ['ピカチュウ'],
        'ピッピ' => ['ピクシー'],
        'フカマル' => ['ガバイト'],
        'フシギソウ' => ['フシギバナ'],
        'フシギダネ' => ['フシギソウ'],
        'ブビィ' => ['ブーバー'],
        'ブルー' => ['グランブル'],
        'ププリン' => ['プリン'],
        'プリン' => ['プクリン'],
        'ベイリーフ' => ['メガニウム'],
        'ベトベター' => ['ベトベトン'],
        'ベトベター(アローラ)' => ['ベトベトン(アローラ)'],
        'ホーホー' => ['ヨルノズク'],
        'ポッタイシ' => ['エンペルト'],
        'ポッチャマ' => ['ポッタイシ'],
        'ポッポ' => ['ピジョン'],
        'ポニータ' => ['ギャロップ'],
        'ポニータ(ガラル)' => ['ギャロップ(ガラル)'],
        'ポポッコ' => ['ワタッコ'],
        'ポリゴン' => ['ポリゴン2'],
        'ポリゴン2' => ['ポリゴンZ'],
        'マクノシタ' => ['ハリテヤマ'],
        'マグマッグ' => ['マグカルゴ'],
        'マグマラシ' => ['バクフーン'],
        'マダツボミ' => ['ウツドン'],
        'マリル' => ['マリルリ'],
        'マンキー' => ['オコリザル'],
        'ミズゴロウ' => ['ヌマクロー'],
        'ミニリュウ' => ['ハクリュー'],
        'ムチュール' => ['ルージュラ'],
        'メタング' => ['メタグロス'],
        'メノクラゲ' => ['ドククラゲ'],
        'メリープ' => ['モココ'],
        'メルタン' => ['メルメタル'],
        'モウカザル' => ['ゴウカザル'],
        'モココ' => ['デンリュウ'],
        'ヤドン' => ['ヤドラン', 'ヤドキング'],
        'ヤドン(ガラル)' => ['ヤドラン(ガラル)', 'ヤドキング(ガラル)'],
        'ユンゲラー' => ['フーディン'],
        'ヨーギラス' => ['サナギラス'],
        'ラッキー' => ['ハピナス'],
        'ラルトス' => ['キルリア'],
        'リオル' => ['ルカリオ'],
        'リザード' => ['リザードン'],
        'ルクシオ' => ['レントラー'],
        'レディバ' => ['レディアン'],
        'ロコン' => ['キュウコン'],
        'ロコン(アローラ)' => ['キュウコン(アローラ)'],
        'ワカシャモ' => ['バシャーモ'],
        'ワニノコ' => ['アリゲイツ'],
        'ワンリキー' => ['ゴーリキー'],
    ];

    /**
     * 指定ポケモンの全前方進化先を再帰的に取得.
     *
     * @return Pokemon[]
     */
    public static function getForwardEvolutions(
        string $pokemonName,
    ): array {
        /** @var Pokemon[] $result */
        $result = [];
        self::collectEvolutions($pokemonName, $result);

        return $result;
    }

    /**
     * @param Pokemon[] $result
     */
    private static function collectEvolutions(
        string $name,
        array &$result,
    ): void {
        $directEvolutions = self::EVOLUTIONS[$name] ?? [];

        foreach ($directEvolutions as $evoName) {
            $pokemon = PokemonDatabase::findByName($evoName);

            if ($pokemon !== null) {
                $result[] = $pokemon;
                self::collectEvolutions($evoName, $result);
            }
        }
    }
}
